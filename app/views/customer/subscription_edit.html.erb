<section class="customer-list">
  <div class="main">
    <h1>Your Pocket</h1>

    <article class="container">
      <header>
        <p><strong>Your Subscription</strong>
      </header>

      <%= render "customer/edit_#{@stack.user_payment_method}", { :subscription => @subscription, :stack => @subscription.stack, :shipping_cost => @shipping_cost } %>
    </article>
  </div>
</section>

<% if @stack.user.payment_provider_is_pin_payments? %>
  <%= javascript_include_tag "https://test-api.pin.net.au/pin.js" unless Rails.env.production? %>
  <%= javascript_include_tag "https://api.pin.net.au/pin.js" if Rails.env.production? %>
  <script type="text/javascript">
    Pin.setPublishableKey('<%= @stack.user.pin_api_key %>');
  </script>
<% elsif @stack.user.payment_provider_is_stripe? %>
  <%= javascript_include_tag "https://js.stripe.com/v2/" %>
  <script type="text/javascript">
    Stripe.setPublishableKey('<%= @stack.user.stripe_api_key %>');
  </script>
<% elsif @stack.user.payment_provider_is_braintree? %>
  <%= javascript_include_tag "https://js.braintreegateway.com/v1/braintree.js" %>
  <script type="text/javascript">
    var braintree = Braintree.create("<%= @stack.user.braintree_client_side_key %>");
    braintree.onSubmitEncryptForm('new_transaction');
  </script>
<% end %>